<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-US">
	<head>
		<title>Buildr: un outil de build moderne, puissant et efficace</title>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<meta name="copyright" content= "&#169; 2011 Jean-Philippe CARUANA (jp@barreverte.fr) - http://buildr.barreverte.fr" />
		<meta name="duration" content="25" />
		<link rel="stylesheet" href="./styles/slidy.css" type="text/css" />
		<link rel="stylesheet" href="./styles/zen.css" type="text/css" />
		<link rel="stylesheet" href="./styles/vim.css" type="text/css" />
		<script src="./scripts/slidy.js" charset="utf-8" type="text/javascript"></script>
<!-- branchement google analytics -->
<script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-22771607-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>
	</head>
	<body>

		<div class="slide">
			<h1 class="big">buildr</h1>
			<p>Buildr, a simple, powerful and efficient build tool</p>
			<p><em>Show me your build, I'll tell you how healthy your project is</em></p>
			<div id="logo"><img alt"buildr" src="./graphics/buildr.png"></div>
			<ul class="bottom">
				<li>Jean-Philippe Caruana</li>
				<li>Orange - Multimedia Business Services</li>
				<li><a href="http://buildr.barreverte.fr/en/">http://buildr.barreverte.fr/en/</a></li>
			</ul>
		</div>

		<div class="slide">
			<h1>Today</h1>
			<ul>
				<li>we'll talk about build</li>
				<li>we'll see some code (a little)</li>
				<li>I hope I'll give you the will to try buildr</li>
				<li>... and adopt it</li>
			</ul>
		</div>

		<div class="slide">
			<h1>Common build tools</h1>
			<div><img src="./graphics/outils_de_build.png"></div>
		</div>

		<div class="slide">
			<h1>Maven</h1>
			<ul>
				<li> the bright side :-)
						<ul>
							<li>standardization (sources, repos, goals)</li>
							<li>wildly widespread</li>
						</ul>
				</li>
				<li> the dark side :-(
						<ul>
							<li>slooooow</li>
							<li>XML</li>
							<li>black box</li>
							<li>hard to extend</li>
							<li>non incremental build</li>
							<li>wants to do too much (archetypes, site)</li>
						</ul>
				</li>
			</ul>
		</div>

		<div class="slide jp">
			<h1>Buildr</h1>
			<div class="gauche"><img src="./graphics/buildr_rake_ruby.png" /></div>
			<ul class="droite">
				<li>uses the bright side of maven</li>
				<li><em>"internal"</em> descriptive build DSL</li>
				<li>just builds... incrementaly, continuously</li>
				<li>JVM : java, scala, groovy, clojure</li>
				<li>no need for plugins plugins</li>
				<li>write some <em>rake</em> without noticing it</li>
				<li><em>ruby</em> at hand</li>
				<li>code is dynamic : readable and easy to understand/patch source code</li>
			</ul>
		</div>

		<div class="slide">
			<h1 class="big">Objective comparison : a few commands</h1>
			<table>
				<tr>
					<th>maven</th>
					<th>buildr</th>
				</tr>
				<tr class="commande">
					<td>mvn eclipse:eclipse</td>
					<td>buildr eclipse</td>
				</tr>
				<tr class="commande">
					<td>mvn package -Dmaven.test.skip=true</td>
					<td>buildr package test=no</td>
				</tr>
				<tr class="commande">
					<td>mvn test -Dtest=MyTest</td>
					<td>buildr test=MyTest</td>
				</tr>
				<tr class="commande">
					<td>maven test:match -Dmaven.test.match="*MyTest*"</td>
					<td></td>
				</tr>
			</table>
		</div>

		<div class="slide">
			<h1 class="big">Objective comparison : a few figures</h1>
			<table>
				<tr>
					<th></th>
					<th>maven 1</th>
					<th>buildr</th>
				</tr>
				<tr>
					<td><span class="condor">Condor</span> : SLOC</td>
					<td>1053</td>
					<td>750</td>
				</tr>
				<tr>
					<td><span class="condor">Condor</span> : number of files</td>
					<td>43</td>
					<td>1</td>
				</tr>
				<tr>
					<td><span class="condor">Condor</span> : total build time</td>
					<td>12 min</td>
					<td>2 min 30</td>
				</tr>
				<tr>
					<td><span class="avsp">AVSP</span> : SLOC</td>
					<td>19183</td>
					<td>878</td>
				</tr>
				<tr>
					<td><span class="avsp">AVSP</span> : number of files</td>
					<td>188</td>
					<td>2</td>
				</tr>
				<tr>
					<td><span class="avsp">AVSP</span> : total build time</td>
					<td>around 1/2h</td>
					<td>7 min</td>
				</tr>
				<tr>
					<td><span class="avsp">AVSP</span> : release time</td>
					<td>two people binome 1/2 day (with mistakes)</td>
					<td>5 min (safe)</td>
				</tr>
			</table>
			
			<p>Testimonies found on the Internet : SLOC</p>
			<table>
				<tr>
					<th>maven2 or ant</th>
					<th>buildr</th>
				</tr>
				<tr>
					<td>4652</td>
					<td>698</td>
				</tr>
				<tr>
					<td>768</td>
					<td>28</td>
				</tr>
			</table>
		</div>

		<div class="slide centre_verticalement">
			<h1 class="big">exemple</h1>
			<pre>
<span class="Type">VERSION_NUMBER</span> = <span class="Special">&quot;</span><span class="Constant">1.0.0-SNAPSHOT</span><span class="Special">&quot;</span>
<span class="Type">GROUP</span> = <span class="Special">'</span><span class="Constant">barreverte.fr</span><span class="Special">'</span>
<span class="Type">COPYRIGHT</span> = <span class="Special">'</span><span class="Constant">Barre Verte !</span><span class="Special">'</span>

repositories.remote &lt;&lt; <span class="Special">'</span><span class="Constant"><a href="http://www.ibiblio.org/maven2/">http://www.ibiblio.org/maven2/</a></span><span class="Special">'</span>

desc <span class="Special">'</span><span class="Constant">buildr session</span><span class="Special">'</span>
define <span class="Special">'</span><span class="Constant">exemple</span><span class="Special">'</span> <span class="Statement">do</span>
  project.version = <span class="Type">VERSION_NUMBER</span>
  project.group = <span class="Type">GROUP</span>

  compile.using <span class="Constant">:target</span>=&gt;<span class="Special">'</span><span class="Constant">1.5</span><span class="Special">'</span>, <span class="Constant">:other</span>=&gt;[<span class="Special">'</span><span class="Constant">-encoding</span><span class="Special">'</span>, <span class="Special">'</span><span class="Constant">ISO8859_1</span><span class="Special">'</span>], <span class="Constant">:deprecation</span>=&gt;<span class="Constant">false</span>, <span class="Constant">:debug</span>=&gt;<span class="Constant">true</span>

  desc <span class="Special">'</span><span class="Constant">A lib</span><span class="Special">'</span>
  define <span class="Special">'</span><span class="Constant">A</span><span class="Special">'</span> <span class="Statement">do</span>
    package <span class="Constant">:jar</span>
  <span class="Statement">end</span>

  desc <span class="Special">'</span><span class="Constant">B lib</span><span class="Special">'</span>
  define <span class="Special">'</span><span class="Constant">B</span><span class="Special">'</span> <span class="Statement">do</span>
    compile.with project(<span class="Special">'</span><span class="Constant">A</span><span class="Special">'</span>)
    package <span class="Constant">:jar</span>
  <span class="Statement">end</span>

  desc <span class="Special">'</span><span class="Constant">D lib</span><span class="Special">'</span>
  define <span class="Special">'</span><span class="Constant">D</span><span class="Special">'</span> <span class="Statement">do</span>
    package <span class="Constant">:jar</span>
  <span class="Statement">end</span>

  desc <span class="Special">'</span><span class="Constant">final deliverable</span><span class="Special">'</span>
  define <span class="Special">'</span><span class="Constant">C</span><span class="Special">'</span> <span class="Statement">do</span>
    compile.with projects(<span class="Special">'</span><span class="Constant">A</span><span class="Special">'</span>, <span class="Special">'</span><span class="Constant">B</span><span class="Special">'</span>, <span class="Special">'</span><span class="Constant">D</span><span class="Special">'</span>)
    package <span class="Constant">:war</span>
  <span class="Statement">end</span>
<span class="Statement">end</span> </pre>
		</div>

		<div class="slide">
			<h1 class="big">examples</h1>
			<ul>
				<li>add dependancies :
					<pre>
desc <span class="Special">'</span><span class="Constant">common infrastructure</span><span class="Special">'</span>
define <span class="Special">'</span><span class="Constant">commons</span><span class="Special">'</span> <span class="Statement">do</span>
  compile.with <span class="Type">LOG4J</span>, <span class="Type">MYSQL</span>, <span class="Type">SERVLET_API</span>, <span class="Type">COMMONS_LANG</span>, <span class="Type">XSTREAM</span>
  test.with <span class="Type">JDOM</span>, <span class="Special">'</span><span class="Constant">jspapi:jsp-api:jar:2.0</span><span class="Special">'</span>, <span class="Type">MOCKRUNNER</span>, <span class="Type">SPRING</span>, <span class="Type">SPRING_MOCK</span>, <span class="Type">MOCKITO</span>, <span class="Type">FEST</span>
  package <span class="Constant">:jar</span>
<span class="Statement">end</span> </pre>
				</li>
				<li>group dependancies :
					<pre>
<span class="Type">SPRING_DAO</span> = <span class="Type">Buildr</span>::group(<span class="Special">'</span><span class="Constant">spring-beans</span><span class="Special">'</span>, <span class="Special">'</span><span class="Constant">spring-core</span><span class="Special">'</span>, <span class="Special">'</span><span class="Constant">spring-dao</span><span class="Special">'</span>, <span class="Special">'</span><span class="Constant">spring-jdbc</span><span class="Special">'</span>,
  <span class="Constant">:under</span>=&gt;<span class="Special">'</span><span class="Constant">org.springframework</span><span class="Special">'</span>, <span class="Constant">:version</span>=&gt;<span class="Special">'</span><span class="Constant">1.2.6</span><span class="Special">'</span>) </pre>
				</li>
				<li>non maven2/buildr standard sources :
					<pre>test.resources.from _(<span class="Constant">:src</span>, <span class="Constant">:test</span>, <span class="Constant">:data</span>) </pre>
				</li>
				<li>custom archive format :
					<pre>
generated_lib = package <span class="Constant">:jar</span>
deliverable = package <span class="Constant">:tgz</span>
deliverable.include _(<span class="Special">'</span><span class="Constant">src/main/batch</span><span class="Special">'</span>), <span class="Constant">:as</span>=&gt;<span class="Special">'</span><span class="Constant">batch</span><span class="Special">'</span> 
deliverable.path(<span class="Special">'</span><span class="Constant">batch/lib</span><span class="Special">'</span>).include generated_lib, compile.dependencies </pre>
				</li>
				<li>assert your binaries :
					<pre>check deliverable, <span class="Special">&quot;</span><span class="Constant">scala-library jar should be included, please check that your
$SCALA_HOME points to a  valid folder</span><span class="Special">&quot;</span> <span class="Statement">do</span>
  it.should contain(<span class="Special">'</span><span class="Constant">batch/lib/scala-library.jar</span><span class="Special">'</span>)
<span class="Statement">end</span> </pre>
				</li>
				<li>custom file rights :
					<pre>
chmod <span class="Constant">0755</span>, <span class="Type">Dir</span>[_(<span class="Special">'</span><span class="Constant">src/main/avsp-batch/bin/*</span><span class="Special">'</span>)]
chmod <span class="Constant">0644</span>, <span class="Type">FileList</span>[_(<span class="Special">'</span><span class="Constant">src/main/avsp-batch/etc/**/*.properties</span><span class="Special">'</span>)] </pre>
				</li>
				<li><em>rake</em> taks dependencies :
					<pre>task <span class="Constant">:fitnesse</span> =&gt; [<span class="Constant">:prerequis_fitnesse</span>, <span class="Constant">:fitnesse_wiki_seul</span>] </pre>
				</li>
				<li>transperent integration with <em>Ant</em> tasks :
					<pre>
task <span class="Constant">:fitnesse_wiki_seul</span> <span class="Statement">do</span> |<span class="Identifier">t</span>|
  ant(t.name) <span class="Statement">do</span> |<span class="Identifier">ant</span>|
    ant.taskdef <span class="Constant">:name</span>=&gt;<span class="Special">'</span><span class="Constant">start_fitnesse</span><span class="Special">'</span>, <span class="Constant">:classname</span>=&gt;<span class="Special">'</span><span class="Constant">fitnesse.ant.StartFitnesseTask</span><span class="Special">'</span>,
<span class="Constant">:classpath</span>=&gt;<span class="Type">FITNESSE_JAR</span>
    ant.start_fitnesse <span class="Constant">:wikidirectoryrootpath</span>=&gt;_(<span class="Special">'</span><span class="Constant">src/main</span><span class="Special">'</span>), <span class="Constant">:fitnesseport</span>=&gt;<span class="Constant">8082</span> 
  <span class="Statement">end</span>
<span class="Statement">end</span> </pre>
				</li>
				<li>merge jars :
					<pre>
bouchons = package <span class="Constant">:jar</span>, <span class="Constant">:file</span>=&gt;_(<span class="Special">'</span><span class="Constant">target/bouchons.jar</span><span class="Special">'</span>)
bouchons.merge artifacts(<span class="Type">COMMONS_HTTPCLIENT</span>, <span class="Type">COMMONS_LANG</span>, <span class="Type">LOG4J</span>, project(<span class="Special">'</span><span class="Constant">commons-test</span><span class="Special">'</span>)) </pre>
				</li>
				<li>add <em>ant</em> tasks before a buildr goal :
					<pre>compile.enhance [<span class="Special">'</span><span class="Constant">ma_jolie_tache_ant</span><span class="Special">'</span>] </pre>
				</li>
				<li>test setup :
					<pre>
test.setup { <span class="Type">Rake</span>::<span class="Type">Task</span>[<span class="Special">'</span><span class="Constant">une_belle_tache_rake</span><span class="Special">'</span>].execute } </pre>
				</li>
				<li>customize <em>manifest</em> file :
					<pre>
manifest[<span class="Special">'</span><span class="Constant">Implementation-Version</span><span class="Special">'</span>] = project.version
manifest[<span class="Special">'</span><span class="Constant">Copyright</span><span class="Special">'</span>]              = <span class="Type">COPYRIGHT</span>
manifest[<span class="Special">'</span><span class="Constant">My-Custom-Field</span><span class="Special">'</span>]  = <span class="Type">ANY_VALUE</span> </pre>
				</li>
				<li>maven2 <em>repositories</em> :
					<pre>
repositories.remote &lt;&lt; <span class="Special">'</span><span class="Constant"><a href="http://www.ibiblio.org/maven2/">http://www.ibiblio.org/maven2/</a></span><span class="Special">'</span>
repositories.remote &lt;&lt; <span class="Special">'</span><span class="Constant"><a href="http://mirrors.ibiblio.org/pub/mirrors/maven2">http://mirrors.ibiblio.org/pub/mirrors/maven2</a></span><span class="Special">'</span>
repositories.remote &lt;&lt; <span class="Special">'</span><span class="Constant"><a href="http://maven01b.serveur:8081/nexus/content/groups/public">http://maven01b.serveur:8081/nexus/content/groups/public</a></span><span class="Special">'</span>
repositories.release_to = { <span class="Constant">:url</span>=&gt;<span class="Special">'</span><span class="Constant">sftp://maven01b.serveur:/var/maven-projets/maven</span><span class="Special">'</span>,
  <span class="Constant">:username</span>=&gt;<span class="Special">'</span><span class="Constant">robert.johnson</span><span class="Special">'</span>, <span class="Constant">:password</span>=&gt;<span class="Special">'</span><span class="Constant">Xroads</span><span class="Special">'</span> } </pre>
				</li>
			</ul>
		</div>

		<div class="slide">
			<h1>Dark side of buildr</h1>
			<ul>
				<li>hard to install (gems)</li>
				<li>living code base (can be unstable)</li>
				<li>you'll need to translate your maven artifacts</li>
				<li>not widespread</li>
			</ul>
		</div>

		<div class="slide">
			<h1 class="big">Neighbours</h1>
			<p>buildr, build like you code</p>
			<ul>
				<li>Gradle : a better way to build (<a href=http://www.gradle.org/">http://www.gradle.org/</a>)</li>
				<li>sbt : a simple build tool for Scala projects (<a href="http://code.google.com/p/simple-build-tool/">http://code.google.com/p/simple-build-tool/</a>)</li>
			</ul>
		</div>

		<div class="slide">
			<h1>Références</h1>
			<ul>
				<li>offical website : <a href="http://buildr.apache.org/">buildr.apache.org</a></li>
				<li><a href="http://martinfowler.com/articles/rake.html#DomainSpecificLanguageForBuilds">Martin Fowler "DSL for builds"</a></li>
				<li><a href="http://johlrogge.wordpress.com/2010/12/14/why-i-dont-like-maven/">Why I don't like maven</a></li>
				<li><a href="http://dustin.github.com/2010/04/01/why-not-maven.html">Why I don't use maven</a></li>
				<li>this session : <a href="http://buildr.barreverte.fr/en/">buildr.barreverte.fr/en/</a> and <a href="https://github.com/jpcaruana/presentation_buildr">on github</a></li>
			</ul>
		</div>

	</body>
</html>
